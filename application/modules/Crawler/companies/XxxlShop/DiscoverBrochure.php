<?php

require APPLICATION_PATH . '/../library/Marktjagd/Service/NewGen/Blender.php';

/*
 * Prospekt Crawler für XXXLutz (ID: 80)
 */

class Crawler_Company_XxxlShop_DiscoverBrochure extends Crawler_Generic_Company
{

    public function crawl($companyId)
    {
        $sApi = new Marktjagd_Service_Input_MarktjagdApi();
        $sFtp = new Marktjagd_Service_Transfer_FtpMarktjagd();
        $sPss = new Marktjagd_Service_Input_PhpSpreadsheet();

        $startDate = '01.05.2022';
        $endDate = '02.05.2022';


        $campaigns = [
            10 => [
                'discover_feed_name' => 'Bonial_mkt_21.csv',
                'campaign_title' => 'XXXLutz WSV',
                'campaign_pdf' => 'Offerista_Titelgrafik_1240x1753px_Dezember2.pdf',
                'brochure_number' => 'discover_kw03-2022',
                'categories' => [
                    'path' => 'Partner_Kategorie',
//                    'category_limit' => 26,
                    'values' => [
                        // needs to be the first
                        'Geschirr & Besteck',
                        'Kochen & Backen',
                        'Leuchten',
                        'Schlaftextilien',
                        'Wohntextilien',
                        'Badtextilien',
                        'Gardinen & Vorhänge',
                        'Haushalt & Reinigen'
                    ]
                ],
                'start_date' => '01.05.2022',
                'end_date' => '02.05.2022 23:59:59',
            ]];

        $localPath = $sFtp->connect($companyId, TRUE);
        $list = $sFtp->listFiles();
        $localArticleFile = $sFtp->downloadFtpToDir($list[0], $localPath);
        $aData = $sPss->readFile($localArticleFile, TRUE, ';')->getElement(0)->getData();



        $localBrochurePath = '';
        foreach ($list as $singleFile) {
            if (preg_match('#[^\.]+\.pdf#', $singleFile)) {
                $pdfFile = $singleFile;
                $localBrochurePath = $sFtp->downloadFtpToDir($singleFile, $localPath);
                break;
            }
        }

        $aApiData = $sApi->getActiveArticleCollection($companyId);
        $aArticleIds = [];
        foreach ($aApiData->getElements() as $eApiData) {
            $aArticleIds[$eApiData->getArticleNumber()] = $eApiData->getArticleId();
        }

        foreach ($campaigns as $campaign) {
            if (strtotime($campaign['end_date']) < time()) {
                $this->_logger->info("valid end date reached for campaign: {$campaign['brochure_number']} SKIPPING CAMPAIGN");
                continue;
            }

            foreach ($aData as $singleRow) {
                if (!array_key_exists('Artikelnummer', $singleRow)) {
                    $this->_logger->err('SKIPPING ARTICLE: article row does not contain column "arcticle_number"');
                    continue;
                }

                $articleNumber = $singleRow['Artikelnummer'];

                $path = $campaign['categories']['path'];
                if (!array_key_exists($path, $singleRow)) {
                    $this->_logger->err("SKIPPING ARTICLE {$articleNumber}: article row does not contain column: {$path}.");
                    continue;
                }

                $category = $singleRow[$path];
                if (!in_array($category, $campaign['categories']['values'])) {
                    $this->_logger->info("SKIPPING ARTICLE {$articleNumber}: category: {$category} of article: {$singleRow["arcticle_number"]} not in configured categories.");
                    continue;
                }


                $this->_logger->info("PROCESSING ARTICLE: $articleNumber");
                $apiArticle = $sApi->findArticleByArticleNumber($companyId, $articleNumber);
                if ($apiArticle == false or !array_key_exists('id', $apiArticle)) {
                    $this->_logger->err("SKIPPING ARTICLE: error querying article from API, article_number: {$articleNumber}.");
                    continue;
                }

                $articleNameParts = explode(" ", $apiArticle['title'], 3);
                $articleName = $articleNameParts[0] . " " . $articleNameParts[1];


                $articleIdsForDuplicate[$apiArticle['id']] = true;
                $articleNamesForDuplicate[$articleName] = true;
                $articles[$category][] = $apiArticle['id'];
            }


            $this->_logger->info("preparing Blender request");
            $discover = [];
            foreach ($campaign['categories']['values'] as $category) {
                $products = [];
                foreach ($articles[$category] as $articleIds) {
                    $products[] = [
                        'product_id' => $articleIds,
                        'priority' => rand(1, 3)
                    ];
                }

                $discover[] = [
                    'page_metaphor' => $category,
                    'products' => $products
                ];
            }


            $this->_logger->info("preparing Blender request");
//        $response = Blender::blendApi(80, $discover, 'Discover_XXXLutz_KW03');
            $response = Blender::blendApi($companyId, $discover);

            if ($response['http_code'] != 200) {
                $this->_logger->err($response['error_message']);
                throw new Exception('blender api did not work out');
            }

            $strLayout = $response['body'];

            $cBrochures = new Marktjagd_Collection_Api_Brochure();
            $eBrochure = new Marktjagd_Entity_Api_Brochure();

            $eBrochure->setTitle('XXXLutz: Deutschlands größter WSV')
                ->setBrochureNumber('Discover_XXXLutz_KW03')
                ->setUrl($localBrochurePath)
                ->setVariety('leaflet')
                ->setStart($startDate)
                ->setEnd($endDate)
                ->setVisibleStart($eBrochure->getStart())
                ->setZipCode('16798,16945,16949,17033,17034,17036,17039,17087,17089,17091,17094,17098,17099,17109,17111,17121,17126,17129,17139,17153,17192,17194,17207,17209,17213,17214,17217,17219,17235,17237,17248,17252,17255,17258,17268,17279,17291,17309,17321,17322,17326,17328,17329,17335,17337,17348,17349,17358,17367,17373,17375,17379,17389,17390,17391,17392,17398,17406,17419,17424,17429,17438,17440,17449,17454,17459,17495,17498,17506,17509,19053,19055,19057,19059,19061,19063,19065,19067,19069,19071,19073,19075,19077,19079,19086,19089,19205,19209,19217,19230,19243,19246,19249,19258,19260,19273,19288,19294,19300,19303,19306,19309,19322,19336,19339,19348,19357,19370,19372,19374,19376,19386,19406,19412,19417,21218,21224,21227,21228,21244,21255,21256,21258,21259,21261,21266,21271,21272,21274,21279,21354,21368,21369,21371,21379,21385,21386,21394,21397,21398,21400,21401,21403,21406,21407,21409,21514,21614,21629,21635,21640,21641,21643,21644,21646,21647,21649,21684,21698,21702,21709,21717,21720,21723,21726,21727,21739,22339,22359,22393,22395,22397,22399,22417,22419,22453,22455,22457,22459,22529,22844,22846,22848,22850,22851,22869,22880,22889,22941,22949,22967,23619,23719,23795,23812,23813,23815,23816,23818,23820,23821,23823,23824,23826,23827,23829,23843,23845,23847,23858,23863,23866,23867,23869,23883,23899,23911,23923,23936,23942,23946,23948,23966,23968,23970,23972,23974,23992,23996,23999,24107,24109,24111,24113,24119,24145,24214,24220,24239,24241,24242,24247,24254,24259,24534,24536,24537,24539,24558,24568,24576,24582,24589,24594,24598,24601,24610,24613,24616,24619,24620,24622,24623,24625,24626,24628,24629,24631,24632,24634,24635,24637,24638,24640,24641,24643,24644,24646,24647,24649,24768,24782,24783,24784,24787,24790,24791,24793,24794,24796,24797,24800,24802,24805,24808,24809,24811,24813,24816,24819,25335,25336,25337,25348,25355,25358,25361,25364,25365,25368,25370,25371,25373,25376,25377,25379,25421,25436,25451,25462,25469,25474,25479,25482,25485,25486,25488,25489,25491,25492,25494,25495,25497,25499,25524,25541,25548,25551,25554,25557,25560,25563,25566,25569,25572,25573,25575,25576,25578,25579,25581,25582,25584,25585,25587,25588,25590,25591,25593,25594,25596,25597,25599,25693,25709,25712,25715,25718,25719,25724,26892,26906,26907,27211,27232,27246,27248,27249,27251,27252,27254,27257,27283,27299,27305,27308,27313,27318,27321,27324,27327,27330,27333,27336,27337,27339,27356,27367,27374,27383,27386,27389,27404,27412,27419,27432,27442,27446,27449,27612,27616,27619,27628,27711,27721,27726,27729,28195,28197,28199,28201,28203,28205,28207,28209,28211,28213,28215,28217,28219,28237,28239,28259,28277,28279,28307,28309,28325,28327,28329,28355,28357,28359,28717,28719,28759,28790,28816,28832,28844,28857,28865,28870,28876,28879,29320,29328,29345,29365,29367,29369,29378,29379,29386,29389,29392,29393,29394,29396,29399,29410,29413,29416,29439,29451,29456,29459,29462,29465,29468,29471,29472,29473,29475,29476,29478,29479,29481,29482,29484,29485,29487,29488,29490,29491,29493,29494,29496,29497,29499,29525,29549,29553,29556,29559,29562,29565,29571,29574,29575,29576,29578,29579,29581,29582,29584,29585,29587,29588,29590,29591,29593,29594,29597,29599,29614,29633,29640,29643,29646,29649,29664,29683,29690,29693,29699,31234,31246,31582,31608,31609,31613,31618,31619,31622,31623,31626,31627,31629,31632,31634,31636,31637,31638,35685,35708,35781,35789,35792,35794,35796,35799,36037,36039,36041,36043,36088,36093,36100,36103,36110,36115,36119,36124,36129,36132,36137,36142,36145,36148,36151,36154,36157,36160,36163,36166,36167,36169,36272,36277,36282,36284,36289,36341,36355,36358,36364,36367,36369,36381,36391,36396,36399,36419,36452,36466,38100,38102,38104,38106,38108,38110,38112,38114,38116,38118,38120,38122,38124,38126,38154,38159,38162,38165,38170,38173,38176,38179,38226,38228,38229,38239,38268,38300,38302,38304,38319,38321,38324,38329,38350,38364,38368,38372,38373,38375,38376,38378,38379,38381,38382,38384,38387,38440,38442,38444,38446,38448,38458,38459,38461,38462,38464,38465,38467,38468,38470,38471,38473,38474,38476,38477,38479,38486,38489,38518,38524,38527,38528,38530,38531,38533,38536,38539,38542,38543,38547,38550,38551,38553,38554,38556,38557,38559,39345,39356,39359,39365,39624,39638,39646,39649,40883,40885,42477,42499,42549,42551,42553,42555,42579,42853,42855,42857,42859,42897,42899,45127,45128,45130,45131,45133,45134,45136,45138,45139,45141,45143,45144,45145,45147,45149,45219,45239,45257,45259,45276,45277,45279,45289,45307,45309,45326,45327,45329,45355,45356,45357,45359,45468,45470,45472,45473,45475,45476,45478,45479,45481,45529,45964,45966,45968,46045,46047,46049,46117,46119,46145,46147,46149,46236,46238,46240,46242,46244,46483,46485,46487,46499,46535,46537,46539,46562,46569,47051,47053,47055,47057,47058,47059,47119,47137,47138,47139,47166,47167,47169,47178,47179,47198,47199,47228,47249,47269,47279,47443,47495,48282,48369,48429,48431,48432,48455,48465,48477,48480,48485,48488,48493,48496,48499,48527,48529,48531,48599,48607,48619,48629,48683,49477,49479,49509,49716,49733,49740,49744,49751,49757,49762,49767,49770,49774,49777,49779,49808,49809,49811,49824,49828,49832,49835,49838,49843,49844,49846,49847,49849,51515,51519,51545,51570,51580,51588,51597,51598,51643,51645,51647,51674,51688,51702,51709,51789,52068,52070,52072,52076,52078,52080,52134,52146,52152,52156,52159,52222,52223,52224,52249,52349,52351,52353,52355,52372,52379,52382,52385,52388,52391,52393,52399,52428,52441,52445,52457,52459,52477,52499,52511,52531,53560,53562,53567,53577,53578,53639,53721,53757,53773,53783,53797,53804,53809,53819,53844,55116,55118,55120,55122,55124,55126,55127,55128,55129,55130,55131,55218,55232,55234,55237,55239,55246,55252,55257,55262,55263,55268,55270,55271,55278,55286,55288,55291,55294,55296,55299,55435,55437,55578,56130,56132,56133,56179,56182,56203,56204,56206,56235,56237,56242,56244,56249,56269,56271,56276,56335,56337,56338,56340,56348,56355,56357,56368,56370,56377,56379,56410,56412,56414,56422,56424,56427,56428,56457,56459,56462,56470,56472,56477,56479,56584,57072,57074,57076,57078,57080,57223,57234,57250,57258,57271,57290,57299,57319,57339,57368,57399,57413,57439,57462,57482,57489,57518,57520,57537,57539,57548,57555,57562,57567,57572,57577,57578,57580,57581,57583,57584,57586,57587,57589,57610,57612,57627,57629,57635,57636,57642,57644,57645,57647,57648,58091,58093,58099,58119,58135,58256,58285,58332,58339,58507,58509,58511,58513,58515,58540,58553,58566,58579,58636,58638,58640,58642,58644,58675,58706,58708,58710,58762,58769,58791,58802,58809,58840,58849,60306,60308,60310,60311,60313,60314,60320,60322,60323,60325,60326,60327,60329,60431,60433,60435,60437,60438,60439,60486,60487,60488,60489,60528,60529,60549,60594,60596,60598,60599,61118,61169,61184,61191,61194,61206,61239,61250,61267,61273,61276,61279,61348,61350,61352,61381,61389,61440,61449,61462,61476,61479,63065,63067,63069,63071,63073,63075,63110,63128,63150,63165,63179,63225,63263,63303,63322,63329,63456,63457,63500,63512,63533,63538,63639,63831,63860,63872,63874,63875,63879,63897,63927,63928,63930,64331,64347,64390,64409,64546,64572,64625,64646,64653,64658,64668,64673,64683,64689,64839,64859,65183,65185,65187,65189,65191,65193,65195,65197,65199,65201,65203,65205,65207,65232,65239,65307,65321,65326,65329,65343,65344,65345,65346,65347,65366,65375,65385,65388,65391,65396,65399,65439,65451,65462,65474,65510,65520,65527,65529,65549,65550,65551,65552,65553,65554,65555,65556,65558,65582,65589,65594,65597,65599,65604,65606,65611,65614,65618,65620,65623,65624,65626,65627,65629,65719,65760,65779,65795,65812,65817,65824,65830,65835,65843,65929,65931,65933,65934,65936,67059,67061,67063,67065,67067,67069,67071,67098,67105,67112,67117,67122,67125,67126,67127,67133,67134,67136,67141,67146,67147,67149,67150,67152,67157,67158,67159,67161,67165,67166,67167,67169,67227,67229,67240,67245,67246,67256,67258,67259,67269,67278,67281,67283,67346,67354,67360,67361,67363,67365,67366,67368,67373,67374,67376,67454,67459,67547,67549,67550,67551,67574,67575,67590,67591,67592,67593,67598,67599,68159,68161,68163,68165,68167,68169,68199,68219,68229,68239,68259,68305,68307,68309,68519,68526,68535,68542,68549,68623,68642,68647,68723,68753,68766,68775,68782,68794,68799,68804,68809,69198,69253,69259,69427,69469,69483,69488,69493,69502,69509,69514,69517,69518,70173,70174,70176,70188,70190,70191,70192,70193,70195,70327,70329,70372,70374,70376,70378,70435,70437,70439,70469,70563,70565,70569,70734,70736,70771,70794,70806,70825,71032,71034,71063,71065,71067,71069,71083,71088,71093,71101,71106,71111,71116,71120,71126,71131,71134,71139,71144,71149,71154,71155,71157,71159,71229,71254,71263,71272,71277,71282,71287,71292,71296,71297,71299,71332,71334,71336,71364,71384,71394,71397,71404,71409,71522,71540,71543,71546,71549,71554,71560,71563,71566,71570,71573,71576,71577,71579,71634,71636,71638,71640,71642,71665,71672,71679,71686,71691,71696,71701,71706,71711,71717,71720,71723,71726,71729,71732,71735,71737,71739,72175,72202,72218,72221,72224,72229,73430,73431,73432,73433,73434,73441,73447,73450,73453,73457,73460,73463,73466,73467,73469,73479,73485,73486,73488,73489,73491,73492,73494,73495,73497,73499,73527,73540,73547,73553,73557,73560,73563,73565,73566,73568,73569,73571,73572,73574,73575,73577,73579,73614,73630,73635,73642,73650,73655,73660,73663,73666,73667,73669,73728,73730,73732,73733,73734,73760,73765,73770,73773,73776,73779,74072,74074,74076,74078,74080,74081,74172,74177,74182,74189,74193,74196,74199,74206,74211,74214,74219,74223,74226,74229,74232,74235,74239,74243,74245,74246,74248,74249,74251,74252,74254,74255,74257,74259,74321,74336,74343,74348,74354,74357,74360,74363,74366,74369,74372,74374,74376,74379,74382,74385,74388,74389,74391,74392,74394,74395,74397,74399,74417,74420,74423,74424,74426,74427,74541,74564,74572,74575,74579,74582,74585,74586,74589,74594,74595,74597,74599,74613,74626,74629,74632,74635,74638,74639,74670,74673,74706,74722,74731,74736,74740,74744,74746,74747,74749,74831,74842,74850,74855,74861,74865,74889,74906,74912,74918,74928,74930,74936,75015,75031,75038,75045,75050,75053,75056,75057,75059,75196,75203,75210,75217,75228,75233,75236,75239,75242,75245,75248,75334,75335,75365,75378,75382,75385,75387,75389,75391,75392,75394,75395,75397,75428,75433,75438,75443,75446,75447,76131,76133,76135,76137,76139,76149,76185,76187,76189,76199,76227,76228,76229,76275,76287,76297,76307,76316,76327,76332,76337,76344,76351,76356,76359,76437,76448,76456,76461,76467,76470,76473,76474,76476,76477,76479,76530,76532,76534,76547,76549,76571,76593,76596,76597,76599,76646,76661,76669,76676,76684,76689,76694,76698,76703,76706,76707,76709,76726,76744,76751,76756,76761,76764,76767,76768,76770,76771,76773,76774,76776,76777,76779,76870,76872,77709,77716,77756,77761,77781,77784,77790,77793,77796,77815,77830,77833,77836,77839,77955,77960,77963,77966,77971,77972,77975,77977,77978,78048,78050,78052,78054,78056,78073,78078,78083,78086,78087,78089,78098,78112,78120,78126,78132,78136,78141,78144,78147,78148,78166,78176,78183,78187,78194,78199,78234,78250,78532,78549,78554,78573,78576,78582,78588,78591,78594,78595,78604,78606,78607,78609,78628,78647,78652,78655,78658,78661,78662,78664,78665,78667,78669,78713,78727,78730,78733,78736,78739,79098,79100,79102,79104,79106,79108,79110,79111,79112,79114,79115,79117,79183,79189,79194,79199,79206,79211,79215,79219,79224,79227,79232,79235,79238,79241,79244,79249,79252,79254,79256,79258,79261,79263,79268,79271,79274,79276,79279,79280,79282,79283,79285,79286,79288,79289,79291,79292,79294,79295,79297,79299,79312,79331,79336,79341,79346,79348,79350,79353,79356,79359,79361,79362,79364,79365,79367,79369,79379,79395,79410,79415,79418,79423,79424,79426,79427,79429,79588,79674,79677,79692,79694,79695,79822,79843,79848,79853,79856,79859,79865,79868,79871,79874,79877,79879,80797,80804,80805,80807,80809,80933,80935,80937,80939,80992,80993,80995,80997,80999,81245,81249,81379,81475,81476,81477,81479,81549,81673,81675,81677,81679,81735,81737,81739,81825,81827,81829,81925,81927,81929,82008,82024,82031,82041,82049,82054,82057,82061,82064,82065,82067,82069,82131,82152,82269,82272,82276,82278,82293,82297,82319,82327,82335,82340,82343,82346,82347,82349,82362,82377,82380,82383,82386,82387,82389,82390,82392,82393,82395,82396,82398,82399,82401,82402,82404,82405,82407,82409,82418,82431,82432,82433,82435,82436,82438,82439,82441,82442,82444,82445,82447,82449,82467,82475,82481,82487,82488,82490,82491,82493,82494,82496,82497,82499,82515,82538,82541,82544,82547,82549,83119,83132,83236,83257,83301,83308,83329,83339,83342,83349,83352,83358,83361,83362,83365,83367,83368,83370,83371,83373,83374,83376,83379,83413,83417,83527,83530,83533,83536,83539,83544,83546,83555,83558,83559,83562,83567,83607,83623,83624,83626,83627,83646,83661,83666,83670,83671,83673,83674,83676,83677,83679,83684,83700,83703,83707,83708,84028,84030,84032,84034,84036,84048,84051,84056,84061,84066,84069,84076,84079,84082,84085,84088,84089,84091,84092,84094,84095,84097,84098,84100,84101,84103,84104,84106,84107,84109,84130,84137,84140,84144,84152,84155,84160,84163,84164,84166,84168,84169,84171,84172,84174,84175,84177,84178,84180,84183,84184,84186,84187,84307,84323,84326,84329,84332,84333,84335,84337,84339,84347,84359,84364,84367,84371,84375,84378,84381,84384,84385,84387,84389,84405,84419,84424,84427,84428,84431,84435,84437,84453,84478,84489,84494,84503,84508,84513,84518,84524,84529,84533,84539,84543,84544,84546,84547,84549,84550,84552,84553,84555,84556,84558,84559,84561,84562,84564,84565,84567,84568,84570,84571,84573,84574,84576,84577,84579,85104,85221,85229,85232,85235,85238,85241,85244,85247,85250,85253,85256,85258,85259,85276,85293,85298,85301,85304,85305,85307,85354,85356,85368,85375,85376,85386,85391,85399,85402,85408,85411,85413,85414,85417,85419,85435,85445,85452,85457,85461,85462,85464,85467,85469,85521,85540,85551,85560,85567,85570,85579,85586,85591,85598,85599,85604,85609,85614,85617,85622,85625,85630,85635,85640,85643,85646,85649,85652,85653,85656,85658,85659,85661,85662,85664,85665,85667,85669,85716,85737,85748,85757,85764,85774,85777,85778,86150,86152,86153,86154,86156,86157,86159,86161,86163,86165,86167,86169,86179,86199,86316,86343,86356,86368,86391,86399,86405,86415,86420,86424,86438,86441,86444,86447,86450,86453,86456,86459,86462,86465,86473,86477,86479,86482,86483,86485,86486,86492,86494,86495,86497,86500,86502,86504,86505,86507,86508,86510,86511,86514,86517,86551,86554,86556,86559,86567,86568,86570,86573,86574,86577,86609,86637,86641,86647,86650,86653,86655,86657,86660,86663,86672,86674,86675,86678,86679,86681,86682,86684,86685,86687,86688,86690,86692,86694,86695,86698,86700,86707,86709,86720,86732,86733,86735,86736,86738,86739,86741,86742,86744,86745,86747,86748,86750,86751,86753,86754,86756,86757,86759,86807,86825,86830,86833,86836,86842,86845,86850,86853,86854,86856,86857,86859,86860,86862,86863,86865,86866,86868,86869,86871,86872,86874,86875,86877,86879,86899,86911,86916,86919,86920,86922,86923,86925,86926,86928,86929,86931,86932,86934,86935,86937,86938,86940,86941,86943,86944,86946,86947,86949,86956,86971,86972,86974,86975,86977,86978,86980,86981,86983,86984,86986,86987,86989,87435,87437,87439,87448,87452,87459,87463,87466,87471,87474,87477,87480,87484,87487,87488,87490,87493,87494,87496,87497,87499,87509,87527,87534,87538,87541,87544,87545,87547,87549,87561,87616,87629,87634,87637,87640,87642,87645,87647,87648,87651,87654,87656,87657,87659,87662,87663,87665,87668,87669,87671,87672,87674,87675,87677,87679,87719,87724,87730,87733,87736,87742,87745,87752,87754,87757,87760,87764,87769,87772,87775,87776,87778,87781,87782,87784,87787,87789,88045,88046,88048,88069,88074,88079,88085,88090,88094,88097,88099,88131,88138,88142,88145,88147,88149,88161,88167,88171,88175,88178,88179,88213,88214,88239,88260,88263,88273,88276,88285,88316,88373,88633,88662,88677,88682,88690,88693,88696,88697,88699,88709,88718,88719,89343,89344,89349,89350,89353,89355,89356,89358,89361,89365,89368,89407,89415,89420,89426,89428,89429,89434,89435,89437,89438,89440,89443,89446,89447,89520,89537,89551,89555,89561,89564,89568,90402,90403,90408,90409,90411,90419,90425,90427,90429,90431,90439,90441,90443,90449,90451,90453,90455,90459,90461,90469,90471,90473,90475,90478,90480,90482,90489,90491,90513,90518,90522,90530,90537,90542,90547,90552,90556,90559,90562,90571,90574,90584,90592,90596,90602,90607,90610,90613,90614,91052,91054,91056,91058,91074,91077,91080,91083,91085,91086,91088,91090,91091,91093,91094,91096,91097,91099,91126,91154,91161,91166,91174,91177,91180,91183,91186,91187,91189,91207,91227,91238,91239,91242,91244,91257,91278,91286,91289,91301,91315,91320,91322,91325,91327,91330,91332,91334,91336,91338,91341,91344,91346,91347,91349,91350,91352,91353,91355,91356,91358,91359,91361,91362,91364,91365,91367,91369,91413,91438,91443,91456,91460,91462,91465,91466,91468,91471,91474,91475,91477,91478,91480,91481,91483,91484,91486,91487,91541,91550,91555,91567,91572,91575,91578,91583,91587,91589,91592,91593,91595,91596,91598,91599,91601,91602,91605,91607,91608,91610,91613,91614,91616,91617,91620,91625,91626,91628,91631,91632,91634,91635,91637,91639,91710,91717,91719,91720,91722,91723,91725,91726,91728,91729,91731,91732,91734,91735,91737,91738,91740,91741,91743,91744,91746,91747,91749,91757,91793,91799,91801,91802,91805,92224,92237,92242,92245,92253,92256,92260,92263,92265,92266,92269,92271,92272,92274,92277,92278,92280,92284,92286,92287,92289,92318,92331,92339,92342,92345,92348,92353,92355,92358,92360,92361,92363,92364,92366,92367,92369,92421,92431,92436,92439,92442,92444,92445,92447,92449,92507,92521,92526,92533,92536,92540,92542,92543,92545,92546,92548,92551,92552,92554,92555,92559,92648,92693,92694,92699,92702,92705,92706,92709,92712,92714,92723,93047,93049,93051,93053,93055,93057,93059,93073,93077,93080,93083,93086,93087,93089,93090,93092,93093,93095,93096,93098,93099,93101,93102,93104,93105,93107,93109,93128,93133,93138,93142,93149,93152,93155,93158,93161,93164,93167,93170,93173,93176,93177,93179,93180,93182,93183,93185,93186,93188,93189,93191,93192,93194,93195,93197,93199,93309,93326,93333,93336,93339,93342,93343,93345,93346,93348,93349,93351,93352,93354,93356,93358,93359,93413,93426,93449,93455,93464,93466,93477,93482,93483,93486,93488,93489,93491,93492,93494,93495,93497,93499,94032,94034,94036,94051,94060,94065,94072,94078,94081,94086,94089,94094,94099,94104,94107,94110,94113,94116,94118,94121,94124,94127,94130,94133,94136,94137,94139,94140,94142,94143,94145,94146,94148,94149,94151,94152,94154,94157,94158,94160,94161,94163,94164,94166,94167,94169,94253,94258,94259,94261,94269,94315,94327,94330,94333,94336,94339,94342,94344,94345,94347,94348,94350,94351,94353,94354,94356,94357,94359,94360,94362,94363,94365,94366,94368,94369,94372,94374,94375,94377,94405,94419,94424,94428,94431,94437,94439,94447,94469,94474,94481,94486,94491,94496,94501,94508,94513,94518,94522,94526,94527,94529,94530,94532,94533,94535,94536,94538,94541,94542,94544,94545,94547,94548,94550,94551,94553,94554,94556,94557,94559,94562,94563,94566,94568,94569,94571,94572,94574,94575,94577,94579,95326,95336,95339,95349,95359,95361,95364,95367,95369,95445,95463,95473,95488,95490,95491,95494,95496,95499,95500,95502,95503,95509,95511,95512,95515,96047,96049,96050,96052,96103,96106,96110,96114,96117,96120,96123,96126,96129,96132,96135,96138,96142,96145,96146,96148,96149,96151,96152,96154,96155,96157,96158,96160,96161,96163,96164,96166,96167,96169,96170,96172,96173,96175,96176,96178,96179,96181,96182,96184,96185,96187,96188,96190,96191,96193,96194,96196,96197,96199,96215,96224,96231,96237,96242,96247,96250,96253,96257,96260,96264,96268,96269,96271,96272,96274,96275,96277,96279,96317,96328,96332,96342,96346,96349,96352,96355,96358,96361,96364,96365,96367,96369,96450,96472,96476,96479,96482,96484,96486,96487,96489,97070,97072,97074,97076,97078,97080,97082,97084,97199,97204,97209,97215,97218,97222,97225,97228,97230,97232,97234,97236,97237,97239,97241,97243,97244,97246,97247,97249,97250,97252,97253,97255,97256,97258,97259,97261,97262,97264,97265,97267,97268,97270,97271,97273,97274,97276,97277,97279,97280,97282,97283,97285,97286,97288,97289,97291,97292,97294,97295,97297,97299,97318,97320,97332,97334,97337,97340,97342,97346,97348,97350,97353,97355,97357,97359,97421,97422,97424,97437,97440,97447,97450,97453,97456,97461,97464,97469,97475,97478,97483,97486,97488,97490,97491,97493,97494,97496,97497,97499,97500,97502,97503,97505,97506,97508,97509,97511,97513,97514,97516,97517,97519,97520,97522,97523,97525,97526,97528,97529,97531,97532,97534,97535,97537,97539,97616,97618,97631,97633,97645,97653,97654,97656,97657,97659,97688,97702,97705,97708,97711,97714,97717,97720,97723,97724,97725,97727,97729,97737,97753,97762,97769,97772,97773,97775,97776,97778,97779,97780,97782,97783,97785,97786,97788,97789,97791,97792,97794,97795,97797,97799,97816,97828,97833,97834,97836,97837,97839,97840,97842,97843,97845,97846,97848,97849,97851,97852,97854,97855,97857,97859,97877,97892,97896,97900,97901,97903,97904,97906,97907,97909,97922,97941,97944,97947,97950,97953,97956,97957,97959,97980,97990,97993,97996,97999,98553,98630,98646,98663,98666,98669,98673')
                ->setLayout($strLayout);

            $cBrochures->addElement($eBrochure);

            $sFtp->close();

        }
        return $this->getResponse($cBrochures);
    }
}