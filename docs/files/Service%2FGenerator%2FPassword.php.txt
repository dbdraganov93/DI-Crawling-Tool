<?php

/**
 * Klasse zum Generieren von PasswÃ¶rtern
 *
 * Class Marktjagd_Service_Generator_Password
 */
class Marktjagd_Service_Generator_Password
{
    /**
     * Generiert anhand dem Hashtyp ein Passwortobjekt, incl. Salt + Passwort
     *
     * @param string $hashType Hashtyp, welcher in der PHP-Methode hash() verwendet werden kann
     * @param string|null $passwordUser
     *
     * @return Marktjagd_Entity_Password
     */
    public function generateHashedPassword($hashType, $passwordUser = null)
    {
        if ($passwordUser
            && strlen($passwordUser)
        ) {
            $password = $passwordUser;
        } else {
            $password = md5(uniqid('', true));
        }

        $salt = md5(uniqid('', true));
        $hash = hash($hashType, $salt . $password);

        $ePassword = new Marktjagd_Entity_Password();
        $ePassword->setPassword($password)
                  ->setPasswordHashed($hash)
                  ->setSalt($salt)
                  ->setHashType($hashType);

        return $ePassword;
    }
}

